<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>UX Builder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="builder.css">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<body>
    <div id="app-root" style="display: flex; height: 100vh;">
        <div id="builder-ui">            <div id="tree-view-wrapper">
                <h3>Tree View</h3>
                <div id="tree-view">
                    <tree-node v-for="node in tree" :key="node.id" :node="node" @node-selected="selectElementFromTree">
                    </tree-node>
                </div>
                
                <!-- Save Template Button -->
                <div class="save-section" style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #ccc;">
                    <button @click="saveTemplate" class="btn btn-success btn-sm">
                        üíæ Save Template
                    </button>
                </div>
            </div>

            <hr>            <div id="inspector" v-if="selectedElementId">
                <p>ƒêang ch·ªçn: &lt;{{ selectedElementTag }}&gt;</p>

                <!-- Properties Editor -->
                <div v-if="availableProperties.length > 0 && !selectedLocation" class="properties-editor">
                    <h4>Properties</h4>
                    <div v-for="property in availableProperties" :key="property.name" class="property-item">
                        <label :for="'prop-' + property.name">{{ property.label }}:</label>
                        
                        <!-- Color Input -->
                        <input v-if="property.type === 'color'" 
                               :id="'prop-' + property.name"
                               type="color" 
                               :value="currentProperties[property.name] || property.defaultValue"
                               @input="updateProperty(property.name, $event.target.value)"
                               class="property-input">
                          <!-- Number Input -->
                        <input v-else-if="property.type === 'number'" 
                               :id="'prop-' + property.name"
                               type="number" 
                               :value="currentProperties[property.name] || property.defaultValue"
                               :min="property.min"
                               :max="property.max"
                               @input="updateProperty(property.name, $event.target.value)"
                               class="property-input"
                               :placeholder="property.name === 'fontSize' ? 'Font size (px)' : ''">
                        
                        <!-- Text Input (default) -->
                        <input v-else 
                               :id="'prop-' + property.name"
                               type="text" 
                               :value="currentProperties[property.name] || property.defaultValue"
                               @input="updateProperty(property.name, $event.target.value)"
                               class="property-input">
                    </div>
                    <hr>
                </div>

                <!-- Click '+' -->
                <div v-if="selectedLocation">
                    <p>V·ªã tr√≠: <strong>{{ selectedLocationLabel }}</strong></p>
                    <small>Ch·ªçn m·ªôt h√†nh ƒë·ªông:</small>
                    <button v-for="(action, index) in availableActions" :key="index" @click="executeAction(action)"
                        class="action-button">
                        {{ action.label }}
                    </button>

                    <button @click="cancelAdd" class="action-button-cancel">H·ªßy (Quay l·∫°i)</button>
                </div>

                <!-- Click to Element -->
                <div v-else>
                    <small>Ch·ªçn m·ªôt h√†nh ƒë·ªông (ho·∫∑c r√™ chu·ªôt v√†o khung ƒë·ªÉ th√™m):</small>

                    <!-- V√≤ng l·∫∑p v-for n√†y render T·∫§T C·∫¢ c√°c n√∫t -->
                    <button v-for="(action, index) in availableActions" :key="index" @click="executeAction(action)"
                        class="action-button">
                        {{ action.label }}
                    </button>

                    <!-- Hi·ªÉn th·ªã th√¥ng b√°o n·∫øu kh√¥ng c√≥ h√†nh ƒë·ªông n√†o -->
                    <small v-if="!availableActions.length">R√™ chu·ªôt v√†o khung ƒë·ªÉ th√™m component.</small>
                </div>

            </div>
        </div>

        

        <!-- === BUTTON ADDERS === -->
        <div class="adder-btn" id="adder-top" v-show="adders.top" :style="adders.top"
            @click.stop="selectLocation('ADD_SIBLING_BEFORE')">+</div>
        <div class="adder-btn" id="adder-bottom" v-show="adders.bottom" :style="adders.bottom"
            @click.stop="selectLocation('ADD_SIBLING_AFTER')">+</div>
        <div class="adder-btn" id="adder-left" v-show="adders.left" :style="adders.left"
            @click.stop="selectLocation('ADD_SIBLING_BEFORE')">+</div>
        <div class="adder-btn" id="adder-right" v-show="adders.right" :style="adders.right"
            @click.stop="selectLocation('ADD_SIBLING_AFTER')">+</div>
        <div class="adder-btn" id="adder-inside" v-show="adders.inside" :style="adders.inside"
            @click.stop="selectLocation('ADD_CHILD')">+</div>
    </div>

    <div id="canvas-wrapper">
        <iframe id="canvas"></iframe>
    </div>    <script src="components.js"></script>
    <script src="vue-app.js"></script>
    <script src="jquery-handlers.js"></script>
</body>

</html>