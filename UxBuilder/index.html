<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>UX Builder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="builder.css">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<body>
    <div id="app-root" style="display: flex; height: 100vh;">
        <div id="builder-ui">
            <div id="tree-view-wrapper">
                <h3>Tree View</h3>
                <div id="tree-view">
                    <tree-node v-for="node in tree" :key="node.id" :node="node" @node-selected="selectElementFromTree">
                    </tree-node>
                </div>
            </div>

            <hr>

            <div id="inspector" v-if="selectedElementId">
                <p>Đang chọn: &lt;{{ selectedElementTag }}&gt;</p>

                <!-- Click '+' -->
                <div v-if="selectedLocation">
                    <p>Vị trí: <strong>{{ selectedLocationLabel }}</strong></p>
                    <small>Chọn một hành động:</small>
                    <button v-for="(action, index) in availableActions" :key="index" @click="executeAction(action)"
                        class="action-button">
                        {{ action.label }}
                    </button>

                    <button @click="cancelAdd" class="action-button-cancel">Hủy (Quay lại)</button>
                </div>

                <!-- Click to Element -->
                <div v-else>
                    <small>Chọn một hành động (hoặc rê chuột vào khung để thêm):</small>

                    <!-- Vòng lặp v-for này render TẤT CẢ các nút -->
                    <button v-for="(action, index) in availableActions" :key="index" @click="executeAction(action)"
                        class="action-button">
                        {{ action.label }}
                    </button>

                    <!-- Hiển thị thông báo nếu không có hành động nào -->
                    <small v-if="!availableActions.length">Rê chuột vào khung để thêm component.</small>
                </div>

            </div>
        </div>

        

        <!-- === BUTTON ADDERS === -->
        <div class="adder-btn" id="adder-top" v-show="adders.top" :style="adders.top"
            @click.stop="selectLocation('ADD_SIBLING_BEFORE')">+</div>
        <div class="adder-btn" id="adder-bottom" v-show="adders.bottom" :style="adders.bottom"
            @click.stop="selectLocation('ADD_SIBLING_AFTER')">+</div>
        <div class="adder-btn" id="adder-left" v-show="adders.left" :style="adders.left"
            @click.stop="selectLocation('ADD_SIBLING_BEFORE')">+</div>
        <div class="adder-btn" id="adder-right" v-show="adders.right" :style="adders.right"
            @click.stop="selectLocation('ADD_SIBLING_AFTER')">+</div>
        <div class="adder-btn" id="adder-inside" v-show="adders.inside" :style="adders.inside"
            @click.stop="selectLocation('ADD_CHILD')">+</div>
    </div>

    <div id="canvas-wrapper">
        <iframe id="canvas"></iframe>
    </div>
    <script src="components.js"></script>
    <script src="builder.js"></script>
</body>

</html>